(function(t){function e(e){for(var n,r,i=e[0],c=e[1],l=e[2],h=0,d=[];h<i.length;h++)r=i[h],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&d.push(s[r][0]),s[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],n=!0,i=1;i<a.length;i++){var c=a[i];0!==s[c]&&(n=!1)}n&&(o.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},s={app:0},o=[];function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0e81":function(t,e,a){},1:function(t,e){},2:function(t,e){},"3cd5":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=a("2222"),o=a.n(s),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},i=[],c=a("2877"),l={},u=Object(c["a"])(l,r,i,!1,null,null,null),h=u.exports,d=(a("b0c0"),a("a4d3"),a("e01a"),a("2f62")),f=a("d4ec"),p=a("bee2"),v=(a("a434"),a("ac1f"),function(){function t(e){Object(f["a"])(this,t),this.limit=e,this.history=[],this.current=0}return Object(p["a"])(t,[{key:"add",value:function(t){this.history.splice(this.current,this.history.length),this.history.length>=this.limit&&this.history.shift(),this.history.push(t),this.current=this.history.length,localStorage.vdarw=o.a.project.exportJSON()}},{key:"undo",value:function(){this.canUndo()&&this.history[--this.current].unexec()}},{key:"redo",value:function(){this.canRedo()&&this.history[this.current++].exec()}},{key:"canUndo",value:function(){return this.current>0}},{key:"canRedo",value:function(){return this.history.length>this.current}},{key:"clear",value:function(){this.history=[],this.current=0,localStorage.vdarw="[]"}}]),t}()),m=new v(20),g=a("2909"),y=a("4c17"),x=a.n(y),w=function(){function t(e){var a=e.path;Object(f["a"])(this,t),this._args={path:a},a.name=x()()}return Object(p["a"])(t,[{key:"exec",value:function(){var t;this.removed&&(t=this._args.path).add.apply(t,Object(g["a"])(this.removed))}},{key:"unexec",value:function(){this.removed=this._args.path.removeSegments()}}]),t}(),b={path:null,show:null},C={lastSize:0,lastColor:"#00000FF"},k=function(t){b.show&&b.show.layer===o.a.project.activeLayer&&C.lastSize===Q.state.pencilArgs.size&&C.lastColor===Q.state.pencilArgs.color||(b.show&&b.show.remove(),b.show=null,b.show=new o.a.Path.Circle({center:[0,0],radius:Q.state.pencilArgs.size/2,fillColor:Q.state.pencilArgs.color}),C.lastSize=Q.state.pencilArgs.size,C.lastColor=Q.state.pencilArgs.color),b.show.position=t.point},S=function(t){b.path=new o.a.Path,b.path.strokeColor=Q.state.pencilArgs.color,b.path.strokeWidth=Q.state.pencilArgs.size,b.path.strokeCap="round",b.path.strokeJoin="round",b.path.add(t.point)},$=function(t){b.path&&b.path.add(t.point)},j=function(t){b.path.add(t.point),Q.state.pencilArgs.shake&&b.path.simplify(),m.add(new w({path:b.path})),b.path=null,b.show&&b.show.remove(),b.show=null},A=function(){},z=function(){b.show&&b.show.remove(),b.show=null},O=new o.a.Tool;O.onMouseDown=S,O.onMouseDrag=$,O.onMouseUp=j,O.onMouseMove=k,O.onToggleIn=A,O.onToggleOut=z;var _={path:null,show:null},M={lastSize:0},T=function(t){_.show&&_.show.layer===o.a.project.activeLayer&&M.layer===Q.state.eraserArgs.size||(_.show&&_.show.remove(),_.show=null,_.show=new o.a.Path.Circle({center:[0,0],radius:Q.state.eraserArgs.size/2,strokeColor:"black",fillColor:"white"}),M.lastSize=Q.state.eraserArgs.size),_.show.position=t.point},L=function(t){_.path=new o.a.Path,_.path.strokeColor="white",_.path.strokeWidth=Q.state.eraserArgs.size,_.path.blendMode="destination-out",_.path.strokeCap="round",_.path.strokeJoin="round",_.path.add(t.point)},E=function(t){_.show&&(_.show.position=t.point,_.show.bringToFront()),_.path&&_.path.add(t.point)},D=function(t){_.path.add(t.point),m.add(new w({path:_.path})),_.path=null},I=function(){},P=function(){_.show&&_.show.remove(),_.show=null},B=new o.a.Tool;B.onMouseDown=L,B.onMouseDrag=E,B.onMouseUp=D,B.onMouseMove=T,B.onToggleIn=I,B.onToggleOut=P;var N={prevSelection:null};function V(){if(N.prevSelection){var t=N.prevSelection.path||N.prevSelection;t.bounds.selected=!1,t.selected=!1,N.prevSelection.selected=!1,N.prevSelection=null}}var R=function(t){V();var e=o.a.project.hitTest(t.point,{tolerance:4,fill:!0,stroke:!0,segments:!0}),a=e&&e.item;if(a){var n="segment"===e.type;a.bounds.selected=!n,n&&(a=e.segment),a.selected=!0}N.prevSelection=a},F=function(){V()},U=new o.a.Tool;U.onMouseDown=R,U.onToggleOut=F;var H={path:null,carryLength:0},J=function(){H.path=new o.a.Path,H.path.fillColor=Q.state.brushArgs.color},X=function(t){if(H.path&&t.delta.length>1){var e=t.delta;e.angle=e.angle+90;var a=e.normalize().multiply(Q.state.brushArgs.size).multiply(1/e.length),n=t.middlePoint.add(a),s=t.middlePoint.subtract(a);H.carryLength=H.carryLength+e.length,H.carryLength>a.length&&(H.path.add(n),H.path.insert(0,s),H.path.smooth(),H.carryLength=0)}},q=function(){Q.state.brushArgs.shake&&H.path.simplify(),m.add(new w({path:H.path})),H.path=null},G=function(){},W=function(){},Y=new o.a.Tool;Y.onMouseDown=J,Y.onMouseDrag=X,Y.onMouseUp=q,Y.onToggleIn=G,Y.onToggleOut=W;var Z={pencil:O,eraser:B,select:U,brush:Y};n["default"].use(d["a"]);var Q=new d["a"].Store({state:{image:"",capture:"",drawing:"",plant:{name:"杜鹃花",data:{}},toolName:null,canvasArgs:{bgColor:"#fff"},pencilArgs:{color:"#000000",size:10,shake:!0},eraserArgs:{size:20},brushArgs:{color:"#000000",size:20,shake:!0},drawSession:{step:0,description:""}},mutations:{setImage:function(t,e){t.image=e},setCapture:function(t,e){t.capture=e},setDrawing:function(t,e){t.drawing=e},setPlant:function(t,e){t.plant.name=e},setPlantData:function(t,e){t.plant.data=e},setStep:function(t){t.drawSession.step<6&&t.drawSession.step++},setDescription:function(t,e){t.drawSession.description=e},setTool:function(t,e){t.toolName&&Z[t.toolName].onToggleOut&&Z[t.toolName].onToggleOut(),t.toolName=e,Z[e]&&(Z[e].activate(),Z[e].onToggleIn&&Z[e].onToggleIn())},setArgs:function(t,e){var a=e.toolName,n=e.color,s=e.size,o=e.shake,r=t[a+"Args"];r.color=n||r.color,r.size=s||r.size,void 0!==o&&(r.shake=o)},setCanvasArgs:function(t,e){Object.assign(t.canvasArgs,e)}},actions:{},modules:{}}),K=a("e37d"),tt=(a("b972"),a("8c4f")),et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"container"}},[a("div",{staticClass:"z-50 absolute bottom-12 left-1/2 transform -translate-x-1/2"},[a("a",{ref:"classification",staticClass:"text",attrs:{id:"classification"}})]),a("div",{ref:"toCanvas",staticClass:"z-50 absolute bottom-6 right-9 hidden"},[a("router-link",{staticClass:"mx-6",attrs:{to:"/canvas"}},[a("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/next.svg"}})])],1),t._m(0),a("VCapture",{staticClass:"z-50 absolute top-1/2 right-5 transform -translate-y-1/2",on:{click:function(e){return t.onCapture()}}}),t._m(1),a("div",{ref:"clear",staticClass:"z-50 absolute w-80 h-80 left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 hidden",on:{click:function(e){return t.clear()}}}),a("div",{ref:"canvasWrapper",staticClass:"video z-0 overflow-hidden hidden absolute bottom-0"},[a("canvas",{ref:"canvas",attrs:{id:"canvas"}})]),a("div",{staticClass:"video z-0 overflow-hidden absolute bottom-0"},[a("video",{ref:"video",attrs:{width:"1194",height:"760",id:"video",playsinline:"",autoplay:""}})])],1)},at=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"z-50 absolute top-12 left-1/2 transform -translate-x-1/2"},[a("p",{staticClass:"text"},[t._v("按下快门，和我一起写生吧！")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"z-40 absolute bottom-0"},[a("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/png/cover.png"}})])}],nt=a("5530"),st=(a("d3b7"),a("159b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{on:{click:t.handleClick}},[t._m(0)])}),ot=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("i",[a("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/shot.svg"}})])}],rt={methods:{handleClick:function(t){this.$emit("click",t)}}},it=rt,ct=Object(c["a"])(it,st,ot,!1,null,"50c92132",null),lt=ct.exports,ut=[{name:"杜鹃花",type:"被子植物门·双子叶植物纲·杜鹃花目·杜鹃花科·杜鹃属",draw:["我是杜鹃花，一般在春季开花，每簇花2到6朵，花冠漏斗形。叶革质，常集生枝端，卵形、椭圆状卵形或倒卵形或倒卵形至倒披针形。","我有红、淡红、杏红、雪青、白色等不同颜色的品种，花色繁茂艳丽。我的花冠上往往会有一些斑点。我的分枝多而纤细，密被亮棕褐色扁平糙伏毛。","我主要生活在亚洲，常出现在山地疏灌丛或松林下，周围会有很多绿叶，也会有一些小昆虫会出现在我的身边。"],data:["杜鹃（学名：Rhododendron simsii Planch.）：是双子叶植物纲、杜鹃花科、杜鹃属的常绿灌木、落叶灌木。又名映山红、山石榴。相传，古有杜鹃鸟，日夜哀鸣而咯血，染红遍山的花朵，因而得名。杜鹃花一般春季开花，每簇花2-6朵，花冠漏斗形，有红、淡红、杏红、雪青、白色等，花色繁茂艳丽。生于海拔500-1200（-2500）米的山地疏灌丛或松林下，为中国中南及西南典型的酸性土指示植物。","该物种全株供药用：有行气活血、补虚，治疗内伤咳嗽，肾虚耳聋，月经不调，风湿等疾病。又因花冠鲜红色，为著名的花卉植物，具有较高的观赏价值，在世界各公园中均有栽培。中国江西、安徽、贵州以杜鹃花为省花，定为市花的城市多达七八个。1985年5月杜鹃花被评为中国十大名花之六。","原产于东亚，生长在海拔500-2700米的高度。野生物种分布于中国、日本、老挝、缅甸和泰国。"]},{name:"茉莉花",type:"被子植物门·双子叶植物纲·杜鹃花目·杜鹃花科·杜鹃属",draw:["我是杜鹃花，一般在春季开花，每簇花2到6朵，花冠漏斗形。叶革质，常集生枝端，卵形、椭圆状卵形或倒卵形或倒卵形至倒披针形。","我有红、淡红、杏红、雪青、白色等不同颜色的品种，花色繁茂艳丽。我的花冠上往往会有一些斑点。我的分枝多而纤细，密被亮棕褐色扁平糙伏毛。","我主要生活在亚洲，常出现在山地疏灌丛或松林下，周围会有很多绿叶，也会有一些小昆虫会出现在我的身边。"],data:["杜鹃（学名：Rhododendron simsii Planch.）：是双子叶植物纲、杜鹃花科、杜鹃属的常绿灌木、落叶灌木。又名映山红、山石榴。相传，古有杜鹃鸟，日夜哀鸣而咯血，染红遍山的花朵，因而得名。杜鹃花一般春季开花，每簇花2-6朵，花冠漏斗形，有红、淡红、杏红、雪青、白色等，花色繁茂艳丽。生于海拔500-1200（-2500）米的山地疏灌丛或松林下，为中国中南及西南典型的酸性土指示植物。","该物种全株供药用：有行气活血、补虚，治疗内伤咳嗽，肾虚耳聋，月经不调，风湿等疾病。又因花冠鲜红色，为著名的花卉植物，具有较高的观赏价值，在世界各公园中均有栽培。中国江西、安徽、贵州以杜鹃花为省花，定为市花的城市多达七八个。1985年5月杜鹃花被评为中国十大名花之六。","原产于东亚，生长在海拔500-2700米的高度。野生物种分布于中国、日本、老挝、缅甸和泰国。"]}],ht={components:{VCapture:lt},data:function(){return{video:"",imgData:"",canvas:"",context:"",scale:1,sketch:new Image,windowWidth:1194,windowHeight:897}},computed:Object(nt["a"])({},Object(d["b"])(["capture","plant"])),methods:{errorHandler:function(t){console.log("navigator.getUserMedia error: ",t)},gotStream:function(t){return window.stream=t,this.video.srcObject=t,navigator.mediaDevices.enumerateDevices()},start:function(){window.stream&&window.stream.getTracks().forEach((function(t){t.stop()}));var t={video:{facingMode:"environment"}};navigator.mediaDevices.getUserMedia(t).then(this.gotStream).catch(this.errorHandler)},onCapture:function(){this.$refs.canvasWrapper.classList.toggle("hidden"),this.$refs.clear.classList.toggle("hidden"),this.video.classList.toggle("hidden"),this.context.drawImage(this.video,0,0,this.canvas.width/this.scale,this.canvas.height/this.scale),this.imgData=this.canvas.toDataURL("image/jpeg"),this.$store.commit("setCapture",this.imgData),this.onConfirm()},onConfirm:function(){var t=new XMLHttpRequest;t.open("POST","https://ztodesign.cn:5000/photo2sketch",!0),t.setRequestHeader("cache-control","no-cache");var e=new FormData;e.append("image",this.imgData);var a=this;t.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE&&200===this.status){var e=JSON.parse(t.responseText);e&&(a.$store.commit("setImage",e.data.resImage),a.setPlantData(a),document.getElementById("classification").innerHTML=e.data.class,a.$refs.toCanvas.classList.toggle("hidden"))}},t.send(e)},setPlantData:function(t){for(var e=0;e<ut.length;e++)t.plant.name===ut[e].name&&t.$store.commit("setPlantData",ut[e])},clear:function(){this.$refs.canvasWrapper.classList.toggle("hidden"),this.$refs.toCanvas.classList.toggle("hidden"),this.video.classList.toggle("hidden"),this.$refs.clear.classList.toggle("hidden"),document.getElementById("classification").innerHTML=""}},mounted:function(){document.body.addEventListener("touchmove",(function(t){t.preventDefault()}),{passive:!1}),this.video=this.$refs.video,this.canvas=this.$refs.canvas,this.context=this.canvas.getContext("2d"),this.scale=window.devicePixelRatio,this.canvas.width=Math.floor(this.windowWidth),this.canvas.height=Math.floor(this.windowHeight),this.context.scale(this.scale,this.scale);var t=this;this.sketch.onload=function(){t.context.drawImage(this,0,0,t.canvas.width/t.scale,t.canvas.height/t.scale)},navigator.mediaDevices.enumerateDevices().catch(this.errorHandler),this.start()}},dt=ht,ft=(a("9e7e"),Object(c["a"])(dt,et,at,!1,null,"510efd26",null)),pt=ft.exports,vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"canvas w-full h-full flex flex-col justify-between items-center overflow-hidden",class:{default:t.isDefault,image:!t.isDefault},style:{backgroundImage:t.getBg}},[a("div",{staticClass:"absolute flex flex-row justify-between items-center bg-white rounded-b-2xl"},[a("VHeader")],1),a("canvas",{ref:"canvas",staticClass:"w-full h-screen",style:t.cursor+t.canvasBg,attrs:{id:"canvas",resize:""}}),a("VDialogue",{ref:"sidebar",staticClass:"absolute top-1/2 left-0 transform -translate-y-2/3 transition duration-500 ease-in-out",on:{click:t.toggleSideBar,toggleMagnifier:t.toggleMagnifier}}),t.drawSession.step<4?a("VContent",{staticClass:"absolute bottom-12"}):t._e(),a("VNext",{staticClass:"absolute bottom-12 left-16",on:{click:t.exportSvg}}),t.drawSession.step<4?a("VTrump",{staticClass:"absolute bottom-11 right-16"}):t._e(),a("VMagnifier",{ref:"magnifier",staticClass:"absolute top-8 left-16 border-4 border-yellow-400 rounded-full transition duration-500 ease-in-out transform -translate-y-64",on:{click:function(e){t.toggleSideBar(),t.toggleMagnifier()}}})],1)},mt=[],gt=(a("99af"),a("b680"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex items-center justify-center flex-wrap w-96 h-20"},[a("VPicker",{staticClass:"transform -translate-y-2"}),a("VTools",{staticClass:"transform -translate-y-2"})],1)}),yt=[],xt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex items-center gap-x-10"},[a("v-popover",{attrs:{disabled:t.disabledSize,offset:"6"}},[a("VIconBtn",{ref:"pencil",staticClass:"transform -translate-y-5 transition duration-300 ease-in-out",attrs:{title:"画笔(P)",active:"pencil"===t.toolName,name:"pencil"},on:{click:function(e){return t.setTool("pencil")}}}),a("template",{slot:"popover"},[a("div",{staticClass:"v-size-picker"},[a("VueSlider",{attrs:{min:1},model:{value:t.size,callback:function(e){t.size=e},expression:"size"}})],1)])],2),a("v-popover",{attrs:{disabled:t.disabledSize,offset:"6"}},[a("VIconBtn",{ref:"brush",staticClass:"transform -translate-y-5 transition duration-300 ease-in-out",attrs:{title:"刷子(B)",active:"brush"===t.toolName,name:"brush"},on:{click:function(e){return t.setTool("brush")}}}),a("template",{slot:"popover"},[a("div",{staticClass:"v-size-picker"},[a("VueSlider",{attrs:{min:1},model:{value:t.size,callback:function(e){t.size=e},expression:"size"}})],1)])],2),a("v-popover",{attrs:{disabled:t.disabledSize,offset:"16"}},[a("VIconBtn",{attrs:{title:"擦除(E)",active:"eraser"===t.toolName,name:"eraser"},on:{click:function(e){return t.setTool("eraser")}}}),a("template",{slot:"popover"},[a("div",{staticClass:"v-size-picker"},[a("VueSlider",{attrs:{min:1},model:{value:t.size,callback:function(e){t.size=e},expression:"size"}})],1)])],2)],1)},wt=[],bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{on:{click:t.handleClick}},[a("i",[a("img",{attrs:{src:t.src,alt:t.name}})])])},Ct=[],kt={props:{active:Boolean,disabled:Boolean,name:String},computed:{src:function(){return"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/"+this.name+".svg"}},methods:{handleClick:function(t){this.disabled||this.$emit("click",t)}}},St=kt,$t=Object(c["a"])(St,bt,Ct,!1,null,"6cc9eac0",null),jt=$t.exports,At=a("4971"),zt=a.n(At),Ot=(a("8445"),{components:{VIconBtn:jt,VueSlider:zt.a},data:function(){return{size:1}},computed:{toolName:function(){return this.$store.state.toolName},toolArgs:function(){return this.$store.state[this.toolName+"Args"]||{}},disabledSize:function(){return null===this.toolName}},watch:{toolName:function(){this.toolArgs.size&&(this.size=this.toolArgs.size)},size:function(){this.toolArgs.size&&this.$store.commit("setArgs",{toolName:this.toolName,size:this.size})}},methods:{setTool:function(t){"pencil"===t?(this.$refs["brush"].$el.classList.remove("-translate-y-2"),this.$refs["brush"].$el.classList.add("-translate-y-5"),this.$refs["pencil"].$el.classList.remove("-translate-y-5"),this.$refs["pencil"].$el.classList.add("-translate-y-2")):"brush"===t?(this.$refs["pencil"].$el.classList.remove("-translate-y-2"),this.$refs["pencil"].$el.classList.add("-translate-y-5"),this.$refs["brush"].$el.classList.remove("-translate-y-5"),this.$refs["brush"].$el.classList.add("-translate-y-2")):"eraser"===t&&(this.$refs["brush"].$el.classList.remove("-translate-y-2"),this.$refs["brush"].$el.classList.add("-translate-y-5"),this.$refs["pencil"].$el.classList.remove("-translate-y-2"),this.$refs["pencil"].$el.classList.add("-translate-y-5")),this.$store.commit("setTool",t)}},mounted:function(){this.$refs["brush"].$el.classList.remove("-translate-y-2"),this.$refs["brush"].$el.classList.add("-translate-y-5"),this.$refs["pencil"].$el.classList.remove("-translate-y-5"),this.$refs["pencil"].$el.classList.add("-translate-y-2")}}),_t=Ot,Mt=(a("a574"),Object(c["a"])(_t,xt,wt,!1,null,"2d18e012",null)),Tt=Mt.exports,Lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex pr-10"},[a("v-popover",{attrs:{disabled:t.disabledColor,offset:"16"}},[a("VIconBtn",{attrs:{disabled:t.disabledColor,title:"颜色",color:t.color,name:"color"}}),a("template",{slot:"popover"},[a("CompactPicker",{model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1)],2)],1)},Et=[],Dt=a("c345"),It={components:{VIconBtn:jt,CompactPicker:Dt["Compact"]},data:function(){return{color:"#000000"}},computed:Object(nt["a"])(Object(nt["a"])({},Object(d["b"])(["toolName"])),{},{toolArgs:function(){return this.$store.state[this.toolName+"Args"]||{}},disabledColor:function(){return null===this.toolName||"eraser"===this.toolName}}),watch:{toolName:function(){this.toolArgs.color&&(this.color=this.toolArgs.color)},color:function(){this.toolArgs.color&&this.$store.commit("setArgs",{toolName:this.toolName,color:this.color.hex8})}}},Pt=It,Bt=Object(c["a"])(Pt,Lt,Et,!1,null,"2169a79e",null),Nt=Bt.exports,Vt=function(t){t||(t=x()());var e=new o.a.Layer({name:t});return o.a.project.addLayer(e),e},Rt=function(){return o.a.project.clear(),m.clear(),o.a.project},Ft=a("9b6a"),Ut={components:{VTools:Tt,VIconBtn:jt,VPicker:Nt},data:function(){return{history:m}},mounted:function(){Object(Ft["a"])("ctrl+s",this.exportSvg),Object(Ft["a"])("f1",this.help)},methods:{clear:function(){Rt(),Vt()},undo:function(){m.undo()},redo:function(){m.redo()}}},Ht=Ut,Jt=Object(c["a"])(Ht,gt,yt,!1,null,"68e5754c",null),Xt=Jt.exports,qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"test",staticClass:"flex flex-row bg-white rounded-r-2xl"},[a("img",{staticClass:"pl-6",attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/line.svg"}}),a("div",{staticClass:"flex flex-col justify-between items-center",on:{click:t.handleClick}},[a("div",{staticClass:"pt-6"},[a("p",{staticClass:"dialogue"},[a("span",[t._v(t._s(t.content))])])]),a("img",{staticClass:"m-12",attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/len.svg"},on:{click:function(e){return t.$emit("toggleMagnifier")}}})])])},Gt=[];a("a15b"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861");function Wt(t,e){var a="https://tsn.baidu.com/text2audio",n=e||{},s=t||{},o=document.createElement("audio");n.autoplay&&o.setAttribute("autoplay","autoplay"),n.hidden?o.style.display="none":o.setAttribute("controls","controls"),"undefined"!==typeof n.volume&&(o.volume=n.volume),p(n.onInit)&&n.onInit(o);var r=6e4,i=n.timeout||r,c=new XMLHttpRequest;c.open("POST",a);var l={};for(var s in t)l[s]=t[s];l.cuid=l.cuid||l.tok,l.ctp=1,l.lan=l.lan||"zh",l.aue=l.aue||3;var u=[];for(var h in l)u.push(h+"="+encodeURIComponent(l[h]));var d=new FileReader;c.responseType="blob",c.send(u.join("&"));var f=setTimeout((function(){c.abort(),p(n.onTimeout)&&n.onTimeout()}),i);function p(t){return"[object Function]"===Object.prototype.toString.call(t)}c.onreadystatechange=function(){4==c.readyState&&(clearTimeout(f),200==c.status&&("audio/mp3"===c.response.type&&(document.body.appendChild(o),o.setAttribute("src",URL.createObjectURL(c.response)),n.autoDestory&&(o.onended=function(){document.body.removeChild(o)}),p(n.onSuccess)&&n.onSuccess(o)),"application/json"===c.response.type&&(d.onload=function(){var t=d.result;p(n.onError)&&n.onError(t)},d.readAsText(c.response))))}}function Yt(t){console.log(t),Wt({tex:t,tok:"25.460eac2eaa96064987fb7d42b0bdebd9.315360000.1953616249.282335-24318664",spd:5,pit:5,vol:15,per:103},{volume:.3,autoDestory:!0,timeout:1e4,hidden:!0,autoplay:!0})}var Zt={computed:Object(nt["a"])(Object(nt["a"])({},Object(d["b"])(["drawSession"])),{},{content:function(){return 0===this.drawSession.step?"你好呀，小朋友! 我已经帮你绘制了我的轮廓，点击下一步让我们开始写生吧！":1===this.drawSession.step?"小朋友! 你可以通过观察补充我的样子吗？比如我的花瓣，我的叶子等等。":2===this.drawSession.step?"小朋友! 你可以给我涂上颜色和画出纹理吗？如果周围安全的话，试着摸摸看！":3===this.drawSession.step?"小朋友! 你可以观察周围环境并丰富你的画面吗？有没有其他植物或者小昆虫？":4===this.drawSession.step?"小朋友! 听听看，我的周围有什么声音？你可以把它录下来吗？":5===this.drawSession.step?"太棒了！你已经完成了这次的写生，点击下一步查看我的完整信息吧！":""}}),methods:{handleClick:function(t){this.$emit("click",t)}},watch:{content:function(t){Yt(t)}},mounted:function(){this.$refs.test.click(),Yt("你好呀，小朋友! 我已经帮你绘制了我的轮廓，你可以通过观察将我补充完整吗？")}},Qt=Zt,Kt=(a("c76f"),Object(c["a"])(Qt,qt,Gt,!1,null,"351135de",null)),te=Kt.exports,ee=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-wrapper filter drop-shadow-md"},[a("p",{staticClass:"content"},[a("span",[t._v(t._s(t.content))])])])},ae=[],ne={computed:Object(nt["a"])(Object(nt["a"])({},Object(d["b"])(["drawSession","plant"])),{},{content:function(){return this.plant.data==={}?"":0===this.drawSession.step||1===this.drawSession.step?this.plant.data.draw[0]:2===this.drawSession.step?this.plant.data.draw[1]:3===this.drawSession.step?this.plant.data.draw[2]:void 0}})},se=ne,oe=(a("6075"),Object(c["a"])(se,ee,ae,!1,null,"14d4c0b6",null)),re=oe.exports,ie=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{on:{click:t.handleClick}},[t._m(0)])},ce=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("i",[a("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/next.svg"}})])}],le={computed:Object(nt["a"])({},Object(d["b"])(["drawSession"])),methods:{handleClick:function(t){this.$store.commit("setStep"),6===this.drawSession.step&&this.$router.push({path:"/plant"}),this.$emit("click",t)}}},ue=le,he=Object(c["a"])(ue,ie,ce,!1,null,"83887eae",null),de=he.exports,fe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{on:{click:t.handleClick}},[t._m(0)])},pe=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("i",{staticClass:"transition duration-500 ease-in-out transform hover:-translate-y-3"},[a("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/trump.svg"}})])}],ve={computed:Object(nt["a"])({},Object(d["b"])(["drawSession"])),methods:{handleClick:function(t){Yt(this.drawSession.description),this.$emit("click",t)}}},me=ve,ge=Object(c["a"])(me,fe,pe,!1,null,"62fd5933",null),ye=ge.exports,xe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"w-48 h-48 overflow-hidden",attrs:{id:"camera"},on:{click:t.handleClick}},[a("video",{ref:"video",staticClass:"video absolute right-0 top-0 object-cover",attrs:{id:"video",playsinline:"",autoplay:""}})])},we=[],be={data:function(){return{videoElement:""}},methods:{errorHandler:function(t){console.log("navigator.getUserMedia error: ",t)},gotStream:function(t){return window.stream=t,this.videoElement.srcObject=t,navigator.mediaDevices.enumerateDevices()},start:function(){window.stream&&window.stream.getTracks().forEach((function(t){t.stop()}));var t={video:{facingMode:"environment"}};navigator.mediaDevices.getUserMedia(t).then(this.gotStream).catch(this.errorHandler)},handleClick:function(t){this.$emit("click",t)}},mounted:function(){this.videoElement=this.$refs.video,navigator.mediaDevices.enumerateDevices().catch(this.errorHandler),this.start()}},Ce=be,ke=(a("f9d4"),Object(c["a"])(Ce,xe,we,!1,null,"68bd7f1d",null)),Se=ke.exports,$e=function(t){Object(Ft["a"])("b",(function(){return Q.commit("setTool","brush")})),Object(Ft["a"])("p",(function(){return Q.commit("setTool","pencil")})),Object(Ft["a"])("e",(function(){return Q.commit("setTool","eraser")})),Object(Ft["a"])("a",(function(){return Q.commit("setTool","select")})),Object(Ft["a"])("ctrl+z",(function(){return m.undo()})),Object(Ft["a"])("ctrl+shift+z",(function(){return m.redo()})),Object(Ft["a"])("ctrl+q",(function(){Rt(),Vt()}))},je=function(t){o.a.setup(t.canvas),o.a.tool=null,$e(t),document.getElementById("canvas").addEventListener("wheel",(function(e){t.vdrawArgs.zoom=o.a.view.zoom})),o.a.project.importJSON(window.localStorage.vdarw||[]),t.vdrawArgs.size=o.a.view.size,t.vdrawArgs.zoom=o.a.view.zoom,t.isInit=!0},Ae=(a("c19f"),a("ace4"),a("fd87"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),function(){function t(t,e){this.x=t,this.y=e}function e(t,e){this.w=t,this.h=e,this.size=t*e,this.arraybuffer=new ArrayBuffer(this.size),this.data=new Int8Array(this.arraybuffer)}function a(){this.area=0,this.len=0,this.curve={},this.pt=[],this.minX=1e5,this.minY=1e5,this.maxX=-1,this.maxY=-1}function n(t){this.n=t,this.tag=new Array(t),this.c=new Array(3*t),this.alphaCurve=0,this.vertex=new Array(t),this.alpha=new Array(t),this.alpha0=new Array(t),this.beta=new Array(t)}t.prototype.copy=function(){return new t(this.x,this.y)},e.prototype.at=function(t,e){return t>=0&&t<this.w&&e>=0&&e<this.h&&1===this.data[this.w*e+t]},e.prototype.index=function(e){var a=new t;return a.y=Math.floor(e/this.w),a.x=e-a.y*this.w,a},e.prototype.flip=function(t,e){this.at(t,e)?this.data[this.w*e+t]=0:this.data[this.w*e+t]=1},e.prototype.copy=function(){var t,a=new e(this.w,this.h);for(t=0;t<this.size;t++)a.data[t]=this.data[t];return a};var s,o=document.createElement("img"),r=document.createElement("canvas"),i=null,c=[],l={isReady:!1,turnpolicy:"minority",turdsize:2,optcurve:!0,alphamax:1,opttolerance:.2};function u(t){l.isReady&&y(),o.file=t;var e=new FileReader;e.onload=function(t){return function(e){t.src=e.target.result}}(o),e.readAsDataURL(t)}function h(t){l.isReady&&y(),o.src=t}function d(t){var e;for(e in t)t.hasOwnProperty(e)&&(l[e]=t[e])}function f(){r.width=o.width,r.height=o.height;var t=r.getContext("2d");t.drawImage(o,0,0)}function p(){var t=r.getContext("2d");i=new e(r.width,r.height);var a,n,s,o=t.getImageData(0,0,i.w,i.h),c=o.data.length;for(a=0,n=0;a<c;a+=4,n++)s=.2126*o.data[a]+.7153*o.data[a+1]+.0721*o.data[a+2],i.data[n]=s<128?1:0;l.isReady=!0}function v(){var e,n=i.copy(),s=new t(0,0);function o(t){var e=n.w*t.y+t.x;while(e<n.size&&1!==n.data[e])e++;return e<n.size&&n.index(e)}function r(t,e){var a,s,o;for(a=2;a<5;a++){for(o=0,s=1-a;s<=a-1;s++)o+=n.at(t+s,e+a-1)?1:-1,o+=n.at(t+a-1,e+s-1)?1:-1,o+=n.at(t+s-1,e-a)?1:-1,o+=n.at(t-a,e+s)?1:-1;if(o>0)return 1;if(o<0)return 0}return 0}function u(e){var s,o=new a,c=e.x,u=e.y,h=0,d=1;o.sign=i.at(e.x,e.y)?"+":"-";while(1){if(o.pt.push(new t(c,u)),c>o.maxX&&(o.maxX=c),c<o.minX&&(o.minX=c),u>o.maxY&&(o.maxY=u),u<o.minY&&(o.minY=u),o.len++,c+=h,u+=d,o.area-=c*d,c===e.x&&u===e.y)break;var f=n.at(c+(h+d-1)/2,u+(d-h-1)/2),p=n.at(c+(h-d-1)/2,u+(d+h-1)/2);p&&!f?"right"===l.turnpolicy||"black"===l.turnpolicy&&"+"===o.sign||"white"===l.turnpolicy&&"-"===o.sign||"majority"===l.turnpolicy&&r(c,u)||"minority"===l.turnpolicy&&!r(c,u)?(s=h,h=-d,d=s):(s=h,h=d,d=-s):p?(s=h,h=-d,d=s):f||(s=h,h=d,d=-s)}return o}function h(t){var e,a,s,o,r,i,c=t.pt[0].y,l=t.len;for(r=1;r<l;r++)if(e=t.pt[r].x,a=t.pt[r].y,a!==c){for(o=c<a?c:a,s=t.maxX,i=e;i<s;i++)n.flip(i,o);c=a}}while(s=o(s))e=u(s),h(e),e.area>l.turdsize&&c.push(e)}function m(){function e(){this.data=[0,0,0,0,0,0,0,0,0]}function a(t,e,a,n,s){this.x=t,this.y=e,this.xy=a,this.x2=n,this.y2=s}function s(t,e){return t>=e?t%e:t>=0?t:e-1-(-1-t)%e}function o(t,e){return t.x*e.y-t.y*e.x}function r(t,e,a){return t<=a?t<=e&&e<a:t<=e||e<a}function i(t){return t>0?1:t<0?-1:0}function u(t,e){var a,n,s,o=new Array(3);for(o[0]=e.x,o[1]=e.y,o[2]=1,s=0,a=0;a<3;a++)for(n=0;n<3;n++)s+=o[a]*t.at(a,n)*o[n];return s}function h(e,a,n){var s=new t;return s.x=a.x+e*(n.x-a.x),s.y=a.y+e*(n.y-a.y),s}function d(e,a){var n=new t;return n.y=i(a.x-e.x),n.x=-i(a.y-e.y),n}function f(t,e){var a=d(t,e);return a.y*(e.x-t.x)-a.x*(e.y-t.y)}function p(t,e,a){var n,s,o,r;return n=e.x-t.x,s=e.y-t.y,o=a.x-t.x,r=a.y-t.y,n*r-o*s}function v(t,e,a,n){var s,o,r,i;return s=e.x-t.x,o=e.y-t.y,r=n.x-a.x,i=n.y-a.y,s*i-r*o}function m(t,e,a){var n,s,o,r;return n=e.x-t.x,s=e.y-t.y,o=a.x-t.x,r=a.y-t.y,n*o+s*r}function g(t,e,a,n){var s,o,r,i;return s=e.x-t.x,o=e.y-t.y,r=n.x-a.x,i=n.y-a.y,s*r+o*i}function y(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function x(e,a,n,s,o){var r=1-e,i=new t;return i.x=r*r*r*a.x+r*r*e*3*n.x+e*e*r*3*s.x+e*e*e*o.x,i.y=r*r*r*a.y+r*r*e*3*n.y+e*e*r*3*s.y+e*e*e*o.y,i}function w(t,e,a,n,s,o){var r,i,c,l,u,h,d,f,p,m;return r=v(t,e,s,o),i=v(e,a,s,o),c=v(a,n,s,o),l=r-2*i+c,u=-2*r+2*i,h=r,d=u*u-4*l*h,0===l||d<0?-1:(f=Math.sqrt(d),p=(-u+f)/(2*l),m=(-u-f)/(2*l),p>=0&&p<=1?p:m>=0&&m<=1?m:-1)}function b(t){var e,n,s;t.x0=t.pt[0].x,t.y0=t.pt[0].y,t.sums=[];var o=t.sums;for(o.push(new a(0,0,0,0,0)),e=0;e<t.len;e++)n=t.pt[e].x-t.x0,s=t.pt[e].y-t.y0,o.push(new a(o[e].x+n,o[e].y+s,o[e].xy+n*s,o[e].x2+n*n,o[e].y2+s*s))}function C(e){var a,n=e.len,c=e.pt,l=new Array(n),u=new Array(n),h=new Array(4);e.lon=new Array(n);var d,f,p,v,m,g,y,x,w=[new t,new t],b=new t,C=new t,k=new t,S=0;for(f=n-1;f>=0;f--)c[f].x!=c[S].x&&c[f].y!=c[S].y&&(S=f+1),u[f]=S;for(f=n-1;f>=0;f--){h[0]=h[1]=h[2]=h[3]=0,a=(3+3*(c[s(f+1,n)].x-c[f].x)+(c[s(f+1,n)].y-c[f].y))/2,h[a]++,w[0].x=0,w[0].y=0,w[1].x=0,w[1].y=0,S=u[f],v=f;while(1){if(d=0,a=(3+3*i(c[S].x-c[v].x)+i(c[S].y-c[v].y))/2,h[a]++,h[0]&&h[1]&&h[2]&&h[3]){l[f]=v,d=1;break}if(b.x=c[S].x-c[f].x,b.y=c[S].y-c[f].y,o(w[0],b)<0||o(w[1],b)>0)break;if(Math.abs(b.x)<=1&&Math.abs(b.y)<=1||(C.x=b.x+(b.y>=0&&(b.y>0||b.x<0)?1:-1),C.y=b.y+(b.x<=0&&(b.x<0||b.y<0)?1:-1),o(w[0],C)>=0&&(w[0].x=C.x,w[0].y=C.y),C.x=b.x+(b.y<=0&&(b.y<0||b.x<0)?1:-1),C.y=b.y+(b.x>=0&&(b.x>0||b.y<0)?1:-1),o(w[1],C)<=0&&(w[1].x=C.x,w[1].y=C.y)),v=S,S=u[v],!r(S,f,v))break}0===d&&(k.x=i(c[S].x-c[v].x),k.y=i(c[S].y-c[v].y),b.x=c[v].x-c[f].x,b.y=c[v].y-c[f].y,m=o(w[0],b),g=o(w[0],k),y=o(w[1],b),x=o(w[1],k),p=1e7,g<0&&(p=Math.floor(m/-g)),x>0&&(p=Math.min(p,Math.floor(-y/x))),l[f]=s(v+p,n))}for(p=l[n-1],e.lon[n-1]=p,f=n-2;f>=0;f--)r(f+1,l[f],p)&&(p=l[f]),e.lon[f]=p;for(f=n-1;r(s(f+1,n),p,e.lon[f]);f--)e.lon[f]=p}function k(t){function e(t,e,a){var n,s,o,r,i,c,l,u,h,d,f,p,v,m,g=t.len,y=t.pt,x=t.sums,w=0;return a>=g&&(a-=g,w=1),0===w?(n=x[a+1].x-x[e].x,s=x[a+1].y-x[e].y,r=x[a+1].x2-x[e].x2,o=x[a+1].xy-x[e].xy,i=x[a+1].y2-x[e].y2,c=a+1-e):(n=x[a+1].x-x[e].x+x[g].x,s=x[a+1].y-x[e].y+x[g].y,r=x[a+1].x2-x[e].x2+x[g].x2,o=x[a+1].xy-x[e].xy+x[g].xy,i=x[a+1].y2-x[e].y2+x[g].y2,c=a+1-e+g),f=(y[e].x+y[a].x)/2-y[0].x,p=(y[e].y+y[a].y)/2-y[0].y,m=y[a].x-y[e].x,v=-(y[a].y-y[e].y),l=(r-2*n*f)/c+f*f,u=(o-n*p-s*f)/c+f*p,h=(i-2*s*p)/c+p*p,d=v*v*l+2*v*m*u+m*m*h,Math.sqrt(d)}var a,n,o,r,i,c,l,u=t.len,h=new Array(u+1),d=new Array(u+1),f=new Array(u),p=new Array(u+1),v=new Array(u+1),m=new Array(u+1);for(a=0;a<u;a++)l=s(t.lon[s(a-1,u)]-1,u),l==a&&(l=s(a+1,u)),f[a]=l<a?u:l;for(n=1,a=0;a<u;a++)while(n<=f[a])p[n]=a,n++;for(a=0,n=0;a<u;n++)v[n]=a,a=f[a];for(v[n]=u,o=n,a=u,n=o;n>0;n--)m[n]=a,a=p[a];for(m[0]=0,h[0]=0,n=1;n<=o;n++)for(a=m[n];a<=v[n];a++){for(c=-1,r=v[n-1];r>=p[a];r--)i=e(t,r,a)+h[r],(c<0||i<c)&&(d[a]=r,c=i);h[a]=c}for(t.m=o,t.po=new Array(o),a=u,n=o-1;a>0;n--)a=d[a],t.po[n]=a}function S(a){function o(t,e,a,n,s){var o,r,i,c,l,u,h,d,f,p,v,m=t.len,g=t.sums,y=0;while(a>=m)a-=m,y+=1;while(e>=m)e-=m,y-=1;while(a<0)a+=m,y-=1;while(e<0)e+=m,y+=1;o=g[a+1].x-g[e].x+y*g[m].x,r=g[a+1].y-g[e].y+y*g[m].y,i=g[a+1].x2-g[e].x2+y*g[m].x2,c=g[a+1].xy-g[e].xy+y*g[m].xy,l=g[a+1].y2-g[e].y2+y*g[m].y2,u=a+1-e+y*m,n.x=o/u,n.y=r/u,h=(i-o*o/u)/u,d=(c-o*r/u)/u,f=(l-r*r/u)/u,p=(h+f+Math.sqrt((h-f)*(h-f)+4*d*d))/2,h-=p,f-=p,Math.abs(h)>=Math.abs(f)?(v=Math.sqrt(h*h+d*d),0!==v&&(s.x=-d/v,s.y=h/v)):(v=Math.sqrt(f*f+d*d),0!==v&&(s.x=-f/v,s.y=d/v)),0===v&&(s.x=s.y=0)}var r,i,c,l,h,d,f,p,v,m,g,y,x,w,b,C=a.m,k=a.po,S=a.len,$=a.pt,j=a.x0,A=a.y0,z=new Array(C),O=new Array(C),_=new Array(C),M=new Array(3),T=new t;for(a.curve=new n(C),i=0;i<C;i++)c=k[s(i+1,C)],c=s(c-k[i],S)+k[i],z[i]=new t,O[i]=new t,o(a,k[i],c,z[i],O[i]);for(i=0;i<C;i++)if(_[i]=new e,r=O[i].x*O[i].x+O[i].y*O[i].y,0===r)for(c=0;c<3;c++)for(l=0;l<3;l++)_[i].data[3*c+l]=0;else for(M[0]=O[i].y,M[1]=-O[i].x,M[2]=-M[1]*z[i].y-M[0]*z[i].x,h=0;h<3;h++)for(l=0;l<3;l++)_[i].data[3*h+l]=M[h]*M[l]/r;for(i=0;i<C;i++){for(d=new e,f=new t,T.x=$[k[i]].x-j,T.y=$[k[i]].y-A,c=s(i-1,C),h=0;h<3;h++)for(l=0;l<3;l++)d.data[3*h+l]=_[c].at(h,l)+_[i].at(h,l);while(1){if(m=d.at(0,0)*d.at(1,1)-d.at(0,1)*d.at(1,0),0!==m){f.x=(-d.at(0,2)*d.at(1,1)+d.at(1,2)*d.at(0,1))/m,f.y=(d.at(0,2)*d.at(1,0)-d.at(1,2)*d.at(0,0))/m;break}for(d.at(0,0)>d.at(1,1)?(M[0]=-d.at(0,1),M[1]=d.at(0,0)):d.at(1,1)?(M[0]=-d.at(1,1),M[1]=d.at(1,0)):(M[0]=1,M[1]=0),r=M[0]*M[0]+M[1]*M[1],M[2]=-M[1]*T.y-M[0]*T.x,h=0;h<3;h++)for(l=0;l<3;l++)d.data[3*h+l]+=M[h]*M[l]/r}if(p=Math.abs(f.x-T.x),v=Math.abs(f.y-T.y),p<=.5&&v<=.5)a.curve.vertex[i]=new t(f.x+j,f.y+A);else{if(g=u(d,T),x=T.x,w=T.y,0!==d.at(0,0))for(b=0;b<2;b++)f.y=T.y-.5+b,f.x=-(d.at(0,1)*f.y+d.at(0,2))/d.at(0,0),p=Math.abs(f.x-T.x),y=u(d,f),p<=.5&&y<g&&(g=y,x=f.x,w=f.y);if(0!==d.at(1,1))for(b=0;b<2;b++)f.x=T.x-.5+b,f.y=-(d.at(1,0)*f.x+d.at(1,2))/d.at(1,1),v=Math.abs(f.y-T.y),y=u(d,f),v<=.5&&y<g&&(g=y,x=f.x,w=f.y);for(h=0;h<2;h++)for(l=0;l<2;l++)f.x=T.x-.5+h,f.y=T.y-.5+l,y=u(d,f),y<g&&(g=y,x=f.x,w=f.y);a.curve.vertex[i]=new t(x+j,w+A)}}}function $(t){var e,a,n,s=t.curve,o=s.n,r=s.vertex;for(e=0,a=o-1;e<a;e++,a--)n=r[e],r[e]=r[a],r[a]=n}function j(t){var e,a,n,o,r,i,c,u,d,v=t.curve.n,m=t.curve;for(e=0;e<v;e++)a=s(e+1,v),n=s(e+2,v),d=h(.5,m.vertex[n],m.vertex[a]),r=f(m.vertex[e],m.vertex[n]),0!==r?(o=p(m.vertex[e],m.vertex[a],m.vertex[n])/r,o=Math.abs(o),i=o>1?1-1/o:0,i/=.75):i=4/3,m.alpha0[a]=i,i>=l.alphamax?(m.tag[a]="CORNER",m.c[3*a+1]=m.vertex[a],m.c[3*a+2]=d):(i<.55?i=.55:i>1&&(i=1),c=h(.5+.5*i,m.vertex[e],m.vertex[a]),u=h(.5+.5*i,m.vertex[n],m.vertex[a]),m.tag[a]="CURVE",m.c[3*a+0]=c,m.c[3*a+1]=u,m.c[3*a+2]=d),m.alpha[a]=i,m.beta[a]=.5;m.alphacurve=1}function A(e){function a(){this.pen=0,this.c=[new t,new t],this.t=0,this.s=0,this.alpha=0}function o(t,e,a,n,o,r,c){var l,u,d,f,b,C,k,S,$,j,A,z,O,_,M,T,L,E,D,I,P,B,N,V=t.curve.n,R=t.curve,F=R.vertex;if(e==a)return 1;if(l=e,b=s(e+1,V),u=s(l+1,V),f=r[u],0===f)return 1;for(S=y(F[e],F[b]),l=u;l!=a;l=u){if(u=s(l+1,V),d=s(l+2,V),r[u]!=f)return 1;if(i(v(F[e],F[b],F[u],F[d]))!=f)return 1;if(g(F[e],F[b],F[u],F[d])<S*y(F[u],F[d])*-.999847695156)return 1}if(A=R.c[3*s(e,V)+2].copy(),z=F[s(e+1,V)].copy(),O=F[s(a,V)].copy(),_=R.c[3*s(a,V)+2].copy(),C=c[a]-c[e],C-=p(F[0],R.c[3*e+2],R.c[3*a+2])/2,e>=a&&(C+=c[V]),E=p(A,z,O),D=p(A,z,_),I=p(A,O,_),P=E+I-D,D==E)return 1;if(N=I/(I-P),B=D/(D-E),T=D*N/2,0===T)return 1;for(L=C/T,k=2-Math.sqrt(4-L/.3),n.c[0]=h(N*k,A,z),n.c[1]=h(B*k,_,O),n.alpha=k,n.t=N,n.s=B,z=n.c[0].copy(),O=n.c[1].copy(),n.pen=0,l=s(e+1,V);l!=a;l=u){if(u=s(l+1,V),N=w(A,z,O,_,F[l],F[u]),N<-.5)return 1;if(M=x(N,A,z,O,_),S=y(F[l],F[u]),0===S)return 1;if($=p(F[l],F[u],M)/S,Math.abs($)>o)return 1;if(m(F[l],F[u],M)<0||m(F[u],F[l],M)<0)return 1;n.pen+=$*$}for(l=e;l!=a;l=u){if(u=s(l+1,V),N=w(A,z,O,_,R.c[3*l+2],R.c[3*u+2]),N<-.5)return 1;if(M=x(N,A,z,O,_),S=y(R.c[3*l+2],R.c[3*u+2]),0===S)return 1;if($=p(R.c[3*l+2],R.c[3*u+2],M)/S,j=p(R.c[3*l+2],R.c[3*u+2],F[u])/S,j*=.75*R.alpha[u],j<0&&($=-$,j=-j),$<j-o)return 1;$<j&&(n.pen+=($-j)*($-j))}return 0}var r,c,u,d,f,b,C,k,S,$,j,A=e.curve,z=A.n,O=A.vertex,_=new Array(z+1),M=new Array(z+1),T=new Array(z+1),L=new Array(z+1),E=new a,D=new Array(z),I=new Array(z+1);for(c=0;c<z;c++)"CURVE"==A.tag[c]?D[c]=i(p(O[s(c-1,z)],O[c],O[s(c+1,z)])):D[c]=0;for(C=0,I[0]=0,f=A.vertex[0],c=0;c<z;c++)b=s(c+1,z),"CURVE"==A.tag[b]&&(k=A.alpha[b],C+=.3*k*(4-k)*p(A.c[3*c+2],O[b],A.c[3*b+2])/2,C+=p(f,A.c[3*c+2],A.c[3*b+2])/2),I[c+1]=C;for(_[0]=-1,M[0]=0,T[0]=0,u=1;u<=z;u++)for(_[u]=u-1,M[u]=M[u-1],T[u]=T[u-1]+1,c=u-2;c>=0;c--){if(d=o(e,c,s(u,z),E,l.opttolerance,D,I),d)break;(T[u]>T[c]+1||T[u]==T[c]+1&&M[u]>M[c]+E.pen)&&(_[u]=c,M[u]=M[c]+E.pen,T[u]=T[c]+1,L[u]=E,E=new a)}for(r=T[z],S=new n(r),$=new Array(r),j=new Array(r),u=z,c=r-1;c>=0;c--)_[u]==u-1?(S.tag[c]=A.tag[s(u,z)],S.c[3*c+0]=A.c[3*s(u,z)+0],S.c[3*c+1]=A.c[3*s(u,z)+1],S.c[3*c+2]=A.c[3*s(u,z)+2],S.vertex[c]=A.vertex[s(u,z)],S.alpha[c]=A.alpha[s(u,z)],S.alpha0[c]=A.alpha0[s(u,z)],S.beta[c]=A.beta[s(u,z)],$[c]=j[c]=1):(S.tag[c]="CURVE",S.c[3*c+0]=L[u].c[0],S.c[3*c+1]=L[u].c[1],S.c[3*c+2]=A.c[3*s(u,z)+2],S.vertex[c]=h(L[u].s,A.c[3*s(u,z)+2],O[s(u,z)]),S.alpha[c]=L[u].alpha,S.alpha0[c]=L[u].alpha,$[c]=L[u].s,j[c]=L[u].t),u=_[u];for(c=0;c<r;c++)b=s(c+1,r),S.beta[c]=$[c]/($[c]+j[b]);S.alphacurve=1,e.curve=S}e.prototype.at=function(t,e){return this.data[3*t+e]};for(var z=0;z<c.length;z++){var O=c[z];b(O),C(O),k(O),S(O),"-"===O.sign&&$(O),j(O),l.optcurve&&A(O)}}function g(t){t&&(s=t),l.isReady?(v(),m(),s(),s=null):setTimeout(g,100)}function y(){i=null,c=[],s=null,l.isReady=!1}function x(t,e){function a(e){function a(a){var n="C "+(e.c[3*a+0].x*t).toFixed(3)+" "+(e.c[3*a+0].y*t).toFixed(3)+",";return n+=(e.c[3*a+1].x*t).toFixed(3)+" "+(e.c[3*a+1].y*t).toFixed(3)+",",n+=(e.c[3*a+2].x*t).toFixed(3)+" "+(e.c[3*a+2].y*t).toFixed(3)+" ",n}function n(a){var n="L "+(e.c[3*a+1].x*t).toFixed(3)+" "+(e.c[3*a+1].y*t).toFixed(3)+" ";return n+=(e.c[3*a+2].x*t).toFixed(3)+" "+(e.c[3*a+2].y*t).toFixed(3)+" ",n}var s,o=e.n,r="M"+(e.c[3*(o-1)+2].x*t).toFixed(3)+" "+(e.c[3*(o-1)+2].y*t).toFixed(3)+" ";for(s=0;s<o;s++)"CURVE"===e.tag[s]?r+=a(s):"CORNER"===e.tag[s]&&(r+=n(s));return r}var n,s,o,r,l,u=i.w*t,h=i.h*t,d=c.length,f='<svg id="svg" version="1.1" width="'+u+'" height="'+h+'" xmlns="http://www.w3.org/2000/svg">';for(f+='<path d="',s=0;s<d;s++)n=c[s].curve,f+=a(n);return"curve"===e?(o="black",r="none",l=""):(o="none",r="black",l=' fill-rule="evenodd"'),f+='" stroke="'+o+'" fill="'+r+'"'+l+"/></svg>",f}return o.onload=function(){f(),p()},{loadImageFromFile:u,loadImageFromUrl:h,setParameter:d,process:g,getSVG:x,img:o}}),ze={components:{VHeader:Xt,VDialogue:te,VContent:re,VNext:de,VTrump:ye,VMagnifier:Se},data:function(){return{isInit:!1,vdrawArgs:{size:{width:0,height:0},zoom:0},svg:"",Potrace:Ae()}},methods:{toggleSideBar:function(){this.$refs["sidebar"].$el.classList.toggle("-translate-x-44")},toggleMagnifier:function(){this.$refs["magnifier"].$el.classList.toggle("-translate-y-64")},handleFiles:function(){this.Potrace.loadImageFromUrl(this.image);var t=this;this.Potrace.process((function(){var e=document.createElement("div");e.innerHTML=t.Potrace.getSVG(1);var a=e.firstChild,n=a.getElementsByTagName("path"),s=([].forEach.call(n,(function(t){t.setAttribute("fill","#D3D3D3")})),btoa((new XMLSerializer).serializeToString(a)));t.svg="data:image/svg+xml;base64,"+s,t.$store.commit("setImage",t.svg)}))},exportSvg:function(){if(6===this.drawSession.step){console.log("exportSvg");var t=paper.project.exportSVG(),e=t.getElementsByTagName("path"),a=([].forEach.call(e,(function(t){"#ffffff"===t.getAttribute("fill")&&t.setAttribute("fill-opacity",0)})),btoa((new XMLSerializer).serializeToString(t))),n="data:image/svg+xml;base64,"+a;this.$store.commit("setDrawing",n)}}},computed:Object(nt["a"])(Object(nt["a"])({},Object(d["b"])(["image","drawSession","plant"])),{},{isDefault:function(){return""===this.image},getBg:function(){var t="url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxNScgaGVpZ2h0PScxNSc+CiAgPHJlY3Qgd2lkdGg9JzUwJyBoZWlnaHQ9JzUwJyBmaWxsPSIjRjlGOUY5IiAvPgogIDxjaXJjbGUgY3g9IjEiIGN5PSIxIiByPSIwLjgiIGZpbGw9IiNDQUNBQ0IiLz4KPC9zdmc+')";return"url(".concat(this.svg,"), ").concat(t)},cursor:function(){var t=this.$store.state.toolName;return null===t||"brush"===t?"cursor: auto;":"select"!==t?"cursor: none;":"cursor: auto;"},canvasBg:function(){return"background-color: ".concat(this.$store.state.canvasArgs.bgColor,"fa;")},canvas:function(){return this.$refs.canvas}}),mounted:function(){""!==this.image&&this.handleFiles(),je(this),this.$store.commit("setTool","pencil")},filters:{toFixed:function(t){return t.toFixed(2)}}},Oe=ze,_e=(a("dcd9"),Object(c["a"])(Oe,vt,mt,!1,null,null,null)),Me=_e.exports,Te=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plant w-screen h-screen"},[a("router-link",{staticClass:"absolute top-11 left-14",attrs:{to:"/"}},[a("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/back.svg"}})]),a("div",{staticClass:"px-16 pt-44 flex flex-row justify-between items-top"},[a("div",{staticClass:"relative"},[a("div",{staticClass:"w-64 h-64 overflow-hidden border-8 border-yellow-400 rounded-full"},[a("img",{staticClass:"image",attrs:{src:t.capture}})]),a("div",{staticClass:"bg-white absolute w-80 h-80 left-24 top-40 overflow-hidden border-8 border-yellow-400 rounded-full"},[a("div",{staticClass:"image absolute w-80 h-80"},[a("img",{staticClass:"absolute top-0 contour",attrs:{src:t.image}}),a("img",{staticClass:"absolute top-2",attrs:{src:t.drawing}})])])]),a("div",{staticClass:"text pl-48 pr-24"},[a("h1",{staticClass:"text-5xl pb-6",staticStyle:{color:"#14B9F4"}},[t._v(t._s(t.plant.data.name))]),a("h2",{staticClass:"text-3xl pb-10 text-gray-900"},[t._v(t._s(t.plant.data.type))]),a("div",{staticClass:"overflow-auto h-72 text-gray-900",attrs:{id:"desc"}})]),a("div",{staticClass:"absolute bottom-12 right-16"},[a("router-link",{staticClass:"mx-6",attrs:{to:"/others"}},[a("img",{attrs:{src:"https://raw.githubusercontent.com/chaochaooo/Bio_Sketchbook/main/public/assets/svg/next.svg"}})])],1)])],1)},Le=[],Ee={computed:Object(nt["a"])({},Object(d["b"])(["image","capture","drawing","plant"])),mounted:function(){for(var t=document.getElementById("desc"),e=0;e<this.plant.data.data.length;e++){var a=document.createElement("p");a.innerHTML=this.plant.data.data[e],a.setAttribute("class","text-lg pb-3"),t.appendChild(a)}}},De=Ee,Ie=(a("7af5"),Object(c["a"])(De,Te,Le,!1,null,"729ea4e9",null)),Pe=Ie.exports,Be=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div")},Ne=[],Ve={},Re=Ve,Fe=Object(c["a"])(Re,Be,Ne,!1,null,null,null),Ue=Fe.exports;n["default"].use(tt["a"]);var He=[{path:"/",name:"Home",component:pt},{path:"/canvas",name:"Canvas",component:Me},{path:"/plant",name:"Plant",component:Pe},{path:"/others",name:"Others",component:Ue}],Je=new tt["a"]({mode:"hash",base:"",routes:He}),Xe=Je;o.a.install(window),n["default"].prototype.$store=Q,n["default"].config.productionTip=!1,n["default"].use(K["a"]);e["default"]=new n["default"]({store:Q,router:Xe,render:function(t){return t(h)}}).$mount("#app")},5962:function(t,e,a){},6075:function(t,e,a){"use strict";var n=a("e152"),s=a.n(n);s.a},"7af5":function(t,e,a){"use strict";var n=a("0e81"),s=a.n(n);s.a},"88d0":function(t,e,a){},"925d":function(t,e,a){},"9e7e":function(t,e,a){"use strict";var n=a("5962"),s=a.n(n);s.a},a574:function(t,e,a){"use strict";var n=a("88d0"),s=a.n(n);s.a},c76f:function(t,e,a){"use strict";var n=a("3cd5"),s=a.n(n);s.a},d3d9:function(t,e,a){},dcd9:function(t,e,a){"use strict";var n=a("925d"),s=a.n(n);s.a},e152:function(t,e,a){},f9d4:function(t,e,a){"use strict";var n=a("d3d9"),s=a.n(n);s.a}});
//# sourceMappingURL=app.d37cc2fd.js.map